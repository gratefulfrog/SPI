<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>AEM: commsMgr.CommsMgr Class Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">AEM
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../namespaces.html"><span>Packages</span></a></li>
      <li class="current"><a href="../../annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="../../files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="../../classes.html"><span>Data&#160;Structure&#160;Index</span></a></li>
      <li><a href="../../hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="../../functions.html"><span>Data&#160;Fields</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('d3/d8f/classcomms_mgr_1_1_comms_mgr.html','../../');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-attribs">Data Fields</a>  </div>
  <div class="headertitle">
<div class="title">commsMgr.CommsMgr Class Reference</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a04ae9f7e77b5d71a17d8a352a3d5abc2"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d8f/classcomms_mgr_1_1_comms_mgr.html#a04ae9f7e77b5d71a17d8a352a3d5abc2">__init__</a> (self, queue)</td></tr>
<tr class="separator:a04ae9f7e77b5d71a17d8a352a3d5abc2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a93f7783e73908615757702adb4e8c944"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d8f/classcomms_mgr_1_1_comms_mgr.html#a93f7783e73908615757702adb4e8c944">initDevices</a> (self, deviceSSChannelLis)</td></tr>
<tr class="separator:a93f7783e73908615757702adb4e8c944"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a728d657990a4bdd7060337239c072a2f"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d8f/classcomms_mgr_1_1_comms_mgr.html#a728d657990a4bdd7060337239c072a2f">isNullReturn</a> (self, responseLis)</td></tr>
<tr class="separator:a728d657990a4bdd7060337239c072a2f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a06702760c52df20fa6b2fe6de5682324"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d8f/classcomms_mgr_1_1_comms_mgr.html#a06702760c52df20fa6b2fe6de5682324">packNbytes</a> (self, bytes)</td></tr>
<tr class="memdesc:a06702760c52df20fa6b2fe6de5682324"><td class="mdescLeft">&#160;</td><td class="mdescRight">packing/unpacking routines ##############  <a href="#a06702760c52df20fa6b2fe6de5682324">More...</a><br /></td></tr>
<tr class="separator:a06702760c52df20fa6b2fe6de5682324"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa7a52698943641eaa326dae0d1c3186a"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d8f/classcomms_mgr_1_1_comms_mgr.html#aa7a52698943641eaa326dae0d1c3186a">unpackStruct</a> (self, format, packed)</td></tr>
<tr class="separator:aa7a52698943641eaa326dae0d1c3186a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1ae25cd2b951f9da62753ccb7c3af43a"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d8f/classcomms_mgr_1_1_comms_mgr.html#a1ae25cd2b951f9da62753ccb7c3af43a">getOutVec</a> (self, type, nbBytesExpected)</td></tr>
<tr class="separator:a1ae25cd2b951f9da62753ccb7c3af43a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0e71b3942b7c0964b534208239826132"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d8f/classcomms_mgr_1_1_comms_mgr.html#a0e71b3942b7c0964b534208239826132">show</a> (self, transferCount, currentResponseLis, type)</td></tr>
<tr class="separator:a0e71b3942b7c0964b534208239826132"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abcb2f6bc7255d3d06ea3608273e8cfc7"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d8f/classcomms_mgr_1_1_comms_mgr.html#abcb2f6bc7255d3d06ea3608273e8cfc7">masterMsg</a> (self, rightHalfByte)</td></tr>
<tr class="separator:abcb2f6bc7255d3d06ea3608273e8cfc7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0fb2250f9a7434c45c4c3503e40970d5"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d8f/classcomms_mgr_1_1_comms_mgr.html#a0fb2250f9a7434c45c4c3503e40970d5">isMasterMsg</a> (self, byte)</td></tr>
<tr class="separator:a0fb2250f9a7434c45c4c3503e40970d5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a93fe410af9d1066edcab61daf4a86d4d"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d8f/classcomms_mgr_1_1_comms_mgr.html#a93fe410af9d1066edcab61daf4a86d4d">transferLis</a> (self, outLis)</td></tr>
<tr class="separator:a93fe410af9d1066edcab61daf4a86d4d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a56045eb570a4f2f0f857be8650167123"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d8f/classcomms_mgr_1_1_comms_mgr.html#a56045eb570a4f2f0f857be8650167123">getBid</a> (self, currentResponseLis)</td></tr>
<tr class="separator:a56045eb570a4f2f0f857be8650167123"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad9ec5f7cbec097242a6c2c2676993de7"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d8f/classcomms_mgr_1_1_comms_mgr.html#ad9ec5f7cbec097242a6c2c2676993de7">doOneCom</a> (self, type, device, printResults=False)</td></tr>
<tr class="separator:ad9ec5f7cbec097242a6c2c2676993de7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ace2e93f45f1c07659790b92f1d51dd3a"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d8f/classcomms_mgr_1_1_comms_mgr.html#ace2e93f45f1c07659790b92f1d51dd3a">doSynch</a> (self)</td></tr>
<tr class="separator:ace2e93f45f1c07659790b92f1d51dd3a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1d820053e1a02ef43d34fc0550f4956d"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d8f/classcomms_mgr_1_1_comms_mgr.html#a1d820053e1a02ef43d34fc0550f4956d">getSynchTime</a> (self)</td></tr>
<tr class="separator:a1d820053e1a02ef43d34fc0550f4956d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a99018de16e1fb04af661e8a3d755ae7a"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d8f/classcomms_mgr_1_1_comms_mgr.html#a99018de16e1fb04af661e8a3d755ae7a">loop</a> (self, typeLis)</td></tr>
<tr class="separator:a99018de16e1fb04af661e8a3d755ae7a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-attribs"></a>
Data Fields</h2></td></tr>
<tr class="memitem:a8f7b24f19614237aedc8f0be25fac594"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d8f/classcomms_mgr_1_1_comms_mgr.html#a8f7b24f19614237aedc8f0be25fac594">q</a></td></tr>
<tr class="memdesc:a8f7b24f19614237aedc8f0be25fac594"><td class="mdescLeft">&#160;</td><td class="mdescRight">Synchonized queue where data from slaves will be pushed.  <a href="#a8f7b24f19614237aedc8f0be25fac594">More...</a><br /></td></tr>
<tr class="separator:a8f7b24f19614237aedc8f0be25fac594"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a21551457d1e797dd6744bf47fafe8012"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d8f/classcomms_mgr_1_1_comms_mgr.html#a21551457d1e797dd6744bf47fafe8012">spi</a></td></tr>
<tr class="memdesc:a21551457d1e797dd6744bf47fafe8012"><td class="mdescLeft">&#160;</td><td class="mdescRight">Raspberry SPI manager instance.  <a href="#a21551457d1e797dd6744bf47fafe8012">More...</a><br /></td></tr>
<tr class="separator:a21551457d1e797dd6744bf47fafe8012"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a94ecd7ae79a6402f121d0ac0d61d1b25"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d8f/classcomms_mgr_1_1_comms_mgr.html#a94ecd7ae79a6402f121d0ac0d61d1b25">syncTime</a></td></tr>
<tr class="memdesc:a94ecd7ae79a6402f121d0ac0d61d1b25"><td class="mdescLeft">&#160;</td><td class="mdescRight">will contain the system time when the slaves are synched  <a href="#a94ecd7ae79a6402f121d0ac0d61d1b25">More...</a><br /></td></tr>
<tr class="separator:a94ecd7ae79a6402f121d0ac0d61d1b25"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1ea36eaa86e2dff88629a1d27b5aca8b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d8f/classcomms_mgr_1_1_comms_mgr.html#a1ea36eaa86e2dff88629a1d27b5aca8b">typeDict</a></td></tr>
<tr class="memdesc:a1ea36eaa86e2dff88629a1d27b5aca8b"><td class="mdescLeft">&#160;</td><td class="mdescRight">contains information per type of outgoing message, i.e.  <a href="#a1ea36eaa86e2dff88629a1d27b5aca8b">More...</a><br /></td></tr>
<tr class="separator:a1ea36eaa86e2dff88629a1d27b5aca8b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2db907afd91690c86c1c4f9b8b155e7e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d8f/classcomms_mgr_1_1_comms_mgr.html#a2db907afd91690c86c1c4f9b8b155e7e">type2NameDict</a></td></tr>
<tr class="memdesc:a2db907afd91690c86c1c4f9b8b155e7e"><td class="mdescLeft">&#160;</td><td class="mdescRight">an inverse dictionary mapping byte to a string name key: byte as per typeDict value: the string name of the byte  <a href="#a2db907afd91690c86c1c4f9b8b155e7e">More...</a><br /></td></tr>
<tr class="separator:a2db907afd91690c86c1c4f9b8b155e7e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9cc8c017f64edb2f196dd94cc1441afd"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d8f/classcomms_mgr_1_1_comms_mgr.html#a9cc8c017f64edb2f196dd94cc1441afd">nullResponse</a></td></tr>
<tr class="memdesc:a9cc8c017f64edb2f196dd94cc1441afd"><td class="mdescLeft">&#160;</td><td class="mdescRight">null response from slave is sentinel value used to know when to stop polling for data  <a href="#a9cc8c017f64edb2f196dd94cc1441afd">More...</a><br /></td></tr>
<tr class="separator:a9cc8c017f64edb2f196dd94cc1441afd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a271e61b87d5e2edc9e165bf7fdf1c93d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d8f/classcomms_mgr_1_1_comms_mgr.html#a271e61b87d5e2edc9e165bf7fdf1c93d">devices</a></td></tr>
<tr class="memdesc:a271e61b87d5e2edc9e165bf7fdf1c93d"><td class="mdescLeft">&#160;</td><td class="mdescRight">list of SS channels provided at runtime  <a href="#a271e61b87d5e2edc9e165bf7fdf1c93d">More...</a><br /></td></tr>
<tr class="separator:a271e61b87d5e2edc9e165bf7fdf1c93d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6b6e2b8f0beeb2183fac868caa655524"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d8f/classcomms_mgr_1_1_comms_mgr.html#a6b6e2b8f0beeb2183fac868caa655524">bidDict</a></td></tr>
<tr class="memdesc:a6b6e2b8f0beeb2183fac868caa655524"><td class="mdescLeft">&#160;</td><td class="mdescRight">dictionary with placeholder values for the <a class="el" href="../../d3/dfd/class_board.html">Board</a> GUIDs, not yet available key: SS chanel value: GUID value, when available, for the board on that channel  <a href="#a6b6e2b8f0beeb2183fac868caa655524">More...</a><br /></td></tr>
<tr class="separator:a6b6e2b8f0beeb2183fac868caa655524"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><pre class="fragment">CommsMgr implements error detection in spi by splitting all bytes into upper and lower halves
master outgoing bytes are:
* never zero
* of the form 0bnnnn0000  where at least one n is 1
slave incoming bytes are:
* of the form 0b0000nnnn  where there are no constraints on the value of n
Slave response formats and lengths are given in the typeDict member variable.
Normal comms protocol:
* send s_init_t, recover bid values
* wait 1 second (current value, may change in the future)
* loop forever:
  * send s_payload_t, recover a payload and enqueue it
  * wait 0.1 second to allow the slave time to refill its work queue
usage:
* commsMgr = CommsMgr(aQueue)
* commsMgr.loop( [ss channels], s_init_t,s_payload_t])
</pre> </div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a04ae9f7e77b5d71a17d8a352a3d5abc2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def commsMgr.CommsMgr.__init__ </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>queue</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Instance constructor, handles init for member variables known at init time, others are deferred to runtime init.
@param queue: the synchronized queue where data will be pushed for the writer threads to process/
</pre> 
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="ad9ec5f7cbec097242a6c2c2676993de7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def commsMgr.CommsMgr.doOneCom </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>device</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>printResults</em> = <code>False</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Method does a single poll, obtains response, and enqueues it for the writer threads to handle.
Manages exceptions to exit properly, returning True if normal exit, and False if exception.
After doing a poll/repsonse/enqueue it sleeps the amount of time corresponding to the typeDict value
@param type: outgoing byte
@param device: SS line to set
@printResults: True if we want to observe each transfer on stdout, used for debugging
@return True if normal exit, False if stopped by Keyboard Interrupt (Ctrl-C)
</pre> 
</div>
</div>
<a class="anchor" id="ace2e93f45f1c07659790b92f1d51dd3a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def commsMgr.CommsMgr.doSynch </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Called to set the Slave Synch time from the current system time
</pre> 
</div>
</div>
<a class="anchor" id="a56045eb570a4f2f0f857be8650167123"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def commsMgr.CommsMgr.getBid </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>currentResponseLis</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Extracts the Board id (GUID) from the currentResponseLis argument
@param currentRepsonseLis : list of values (re-assembled) received from slave
@return the Board ID (GUID) value
</pre> 
</div>
</div>
<a class="anchor" id="a1ae25cd2b951f9da62753ccb7c3af43a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def commsMgr.CommsMgr.getOutVec </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>nbBytesExpected</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">returns the vector of outgoing bytes as per the type &amp; number of bytes expected args
@param type: a tpe byte
@param nbBytesExpected: the number of bytes expected in reply from slave
@return the list of outgoing bytes needed to get the proper reply via SPI
</pre> 
</div>
</div>
<a class="anchor" id="a1d820053e1a02ef43d34fc0550f4956d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def commsMgr.CommsMgr.getSynchTime </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Gets the current synch time value, warning it may be unset and should be tested, or observed for validity.
</pre> 
</div>
</div>
<a class="anchor" id="a93f7783e73908615757702adb4e8c944"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def commsMgr.CommsMgr.initDevices </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>deviceSSChannelLis</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Initialization call, not part of constructor because these values are not known at
instanciation time.
</pre> 
</div>
</div>
<a class="anchor" id="a0fb2250f9a7434c45c4c3503e40970d5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def commsMgr.CommsMgr.isMasterMsg </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>byte</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a728d657990a4bdd7060337239c072a2f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def commsMgr.CommsMgr.isNullReturn </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>responseLis</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Returns True if the argument is exactly equal to the self.nullRepsonse
@param responseLis : a list of values corresponding to a reply from the slave
@return True if exactly equal to the null response, Fals otherwise
</pre> 
</div>
</div>
<a class="anchor" id="a99018de16e1fb04af661e8a3d755ae7a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def commsMgr.CommsMgr.loop </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>typeLis</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">The loop method for the CommsMgr, also does initiation of SPI.
This method does the runtime initialization of the CommsMgr instance, setting the value
of self.devices.
After init, the 1st outgoing byte is sent to each device, then in an infinite loop
the second ougoing byte is sent to each device in turn.
SPI is managed properly, handling excpetions and exiting correctly in all cases.
The number or polls per device is maintained during the loops and a heartbeat message is
periodically displayed to stdout.
@params typeLis is a list of form [ &lt;SPI devices&gt; &lt;outgoing byte&gt;*] where
SPI devices is [0] or[1] or [0,1]
and outgoing bytes should be s_init_t, s_payload_t
opens SPI
typeLis[0] is the list of SS Channels, ie [0] or [1], or [0,1]
sends each elt in typeLis as per:
[0] : printResults=False
loop indefinitely:
[1] : use default values for  printResults
on exit, closes spi
</pre> 
</div>
</div>
<a class="anchor" id="abcb2f6bc7255d3d06ea3608273e8cfc7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def commsMgr.CommsMgr.masterMsg </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>rightHalfByte</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Returns the outgoing byte, encoded onto 2 bytes as per error detection logic
@param rightHalfByte is the outgoing byte which is in fact only the 4 low order bits
@return the bits shifted to the high order positions.
</pre> 
</div>
</div>
<a class="anchor" id="a06702760c52df20fa6b2fe6de5682324"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def commsMgr.CommsMgr.packNbytes </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>bytes</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>packing/unpacking routines ############## </p>
<pre class="fragment">This will return a pack of unsigned bytes, suitable for unpacking into their
original values.
the argument: bytes : is a list of any length of 
unsigned byte values.
[255, 0, 1, ...]
returns packed bytes of the form:
&gt;&gt;&gt; packNbytes(sss)
b'\x01\n\x00\x00\x00\x00\x00\xc0?'
</pre> 
</div>
</div>
<a class="anchor" id="a0e71b3942b7c0964b534208239826132"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def commsMgr.CommsMgr.show </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>transferCount</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>currentResponseLis</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>type</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Debuggin call used to show information about current comms
@param transferCound: current number of SPI transfers
@currentResponseLis: current reply from slave
@type: current outgoing byte 
</pre> 
</div>
</div>
<a class="anchor" id="a93fe410af9d1066edcab61daf4a86d4d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def commsMgr.CommsMgr.transferLis </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>outLis</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">This method does the SPI transfers and collects the responses. It also collects error information
by detecting that the slave has not responded to poll from the master.
The method handles the SPI logic, ignoring the 1st repsonse, then collecting data into the responseLis
@param outLis is the list of outgoing bytes to send
@return resLis, correctedCount: resLis is the list of re-assembled bytes in response, 
and the corrected count is
the number of outgoing bytes that the slave did not see on their first send, they are resent until 
the slave does see them
</pre> 
</div>
</div>
<a class="anchor" id="aa7a52698943641eaa326dae0d1c3186a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def commsMgr.CommsMgr.unpackStruct </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>format</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>packed</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">This will return a list of values
after unpacking the packed bytes.
Some formats:
b/B : signed/unsigned byte 1
h/H : signed/unsigned short int 2
i/I : signed/unsigned int 4
f   : float 4
d   : double 8
size and byte order:
find the system byteorder by examining 
sys.byteorder
on Intel and RPI it is 'little'
@ native order native size, native alignment (needs examination)
= native order, standard size, no alignment
&lt;/&gt; little/big endian, standard size, no alignment
!   big endian, standard size, no alignment
the correct choice is '&lt;' to get little endian, which is what is needed 
for Arduino and RPI and PC/Intel
Will return a list of things corresponding to format spec.
Ex:
if we have an unsigned byte, unsigned long, float = 9bytes
&gt;&gt;&gt; unpack('&lt;BIf' packNbytes([&lt;9 numbers that are on [0,255]])
[uint8_t, uint32_t, f]
</pre> 
</div>
</div>
<h2 class="groupheader">Field Documentation</h2>
<a class="anchor" id="a6b6e2b8f0beeb2183fac868caa655524"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">commsMgr.CommsMgr.bidDict</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>dictionary with placeholder values for the <a class="el" href="../../d3/dfd/class_board.html">Board</a> GUIDs, not yet available key: SS chanel value: GUID value, when available, for the board on that channel </p>

</div>
</div>
<a class="anchor" id="a271e61b87d5e2edc9e165bf7fdf1c93d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">commsMgr.CommsMgr.devices</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>list of SS channels provided at runtime </p>

</div>
</div>
<a class="anchor" id="a9cc8c017f64edb2f196dd94cc1441afd"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">commsMgr.CommsMgr.nullResponse</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>null response from slave is sentinel value used to know when to stop polling for data </p>

</div>
</div>
<a class="anchor" id="a8f7b24f19614237aedc8f0be25fac594"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">commsMgr.CommsMgr.q</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Synchonized queue where data from slaves will be pushed. </p>

</div>
</div>
<a class="anchor" id="a21551457d1e797dd6744bf47fafe8012"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">commsMgr.CommsMgr.spi</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Raspberry SPI manager instance. </p>

</div>
</div>
<a class="anchor" id="a94ecd7ae79a6402f121d0ac0d61d1b25"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">commsMgr.CommsMgr.syncTime</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>will contain the system time when the slaves are synched </p>

</div>
</div>
<a class="anchor" id="a2db907afd91690c86c1c4f9b8b155e7e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">commsMgr.CommsMgr.type2NameDict</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>an inverse dictionary mapping byte to a string name key: byte as per typeDict value: the string name of the byte </p>

</div>
</div>
<a class="anchor" id="a1ea36eaa86e2dff88629a1d27b5aca8b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">commsMgr.CommsMgr.typeDict</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>contains information per type of outgoing message, i.e. </p>
<p>outgoing byte key: a byte, eg s_init_t or s_payload_t value: a list of form [nnBytes, formatString, waitTime] where: nbBytes is how many bytes to exect in response, formatString is the string to be used for unpacking waitTime is how many seconds before next outgoing poll, i.e. how long the slave can work before disturbing it again. </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>/home/bob/Desktop/temp/Yannick/PhD_Support/temp/SPI/RPI/Python/App/<a class="el" href="../../d3/dd2/comms_mgr_8py.html">commsMgr.py</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../dd/d74/namespacecomms_mgr.html">commsMgr</a></li><li class="navelem"><a class="el" href="../../d3/d8f/classcomms_mgr_1_1_comms_mgr.html">CommsMgr</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="../../doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
